# PDFæå–æœåŠ¡å®ç°æ€»ç»“

## å®ç°æ¦‚è¿°

æœ¬æ–‡æ¡£æ€»ç»“äº†ä¸¥æ ¼æŒ‰ç…§ `pdfæ–‡ä»¶çš„å®ç°.md` è¦æ±‚å®ç°çš„PDFæ–‡æ¡£ç»“æ„åŒ–å†…å®¹æå–æœåŠ¡ã€‚

## âœ… éœ€æ±‚å¯¹ç…§æ£€æŸ¥

### 1. åŸºç¡€è¦æ±‚ âœ…
- [x] **ä½ç½®è¦æ±‚**: æ‰€æœ‰å†…å®¹éƒ½æ”¾åœ¨ `app/service/pdf` ç›®å½•ä¸‹
- [x] **æ–‡ä»¶è¦æ±‚**: åœ¨ `PdfExtractService.py` æ–‡ä»¶ä¸­å®ç°pdfæ–‡ä»¶å†…å®¹çš„æå–
- [x] **æŠ€æœ¯è¦æ±‚**: ä½¿ç”¨ Unstructured åº“
- [x] **æ¥å£è¦æ±‚**: åªæœ‰ä¸€ä¸ªå…¥å£ï¼Œå…¥å‚ä¸ºæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œè¿”å‚ä¸ºjson

### 2. åŠŸèƒ½è¦æ±‚ âœ…
- [x] **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡å¤„ç†
- [x] **å¤šå†…å®¹ç±»å‹**: æå–æ–‡æœ¬ã€æ ‡é¢˜ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰å¤šç§å†…å®¹ç±»å‹
- [x] **åæ ‡è®°å½•**: è®°å½•å…ƒç´ åæ ‡å’Œå…ƒæ•°æ®ä¿¡æ¯  
- [x] **ç»“æ„åŒ–æå–**: ä½¿ç”¨unstructuredåº“è¿›è¡Œç»“æ„åŒ–PDFæå–

### 3. ç›®æ ‡è¦æ±‚ âœ…
- [x] **å‘é‡åŒ–é€‚é…**: JSONæ ¼å¼æ»¡è¶³å‘é‡åŒ–éœ€è¦
- [x] **å®ä½“å…³ç³»é€‚é…**: JSONæ ¼å¼æ»¡è¶³å®ä½“å…³ç³»æå–éœ€è¦
- [x] **æ£€ç´¢ä¼˜åŒ–**: ç»“æ„è®¾è®¡ç¡®ä¿å‘é‡åŒ–å’Œå®ä½“å…³ç³»å¤„ç†åå¯é€šè¿‡æ£€ç´¢æ‰¾åˆ°ç­”æ¡ˆ
- [x] **çŸ¥è¯†åº“é—®ç­”**: æ”¯æŒé¡¹ç›®æ€»ä½“ç›®æ ‡ - å®ç°çŸ¥è¯†åº“çš„é—®ç­”

## ğŸ“ å®ç°æ–‡ä»¶ç»“æ„

```
app/service/pdf/
â”œâ”€â”€ __init__.py                    # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â””â”€â”€ PdfExtractService.py          # âœ… ä¸»è¦å®ç°æ–‡ä»¶

test/
â”œâ”€â”€ test_pdf_extract.py           # âœ… æ›´æ–°çš„æµ‹è¯•æ–‡ä»¶
â””â”€â”€ pdf_extract_example.py        # âœ… ä½¿ç”¨ç¤ºä¾‹å’Œè¯´æ˜
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. PdfExtractService ç±»
```python
class PdfExtractService:
    def extract_pdf_content(self, pdf_file_path: str) -> Dict[str, Any]
```

**ç‰¹ç‚¹:**
- å•ä¸€å…¥å£å‡½æ•°ï¼Œå…¥å‚ä¸ºæ–‡ä»¶ç»å¯¹è·¯å¾„
- è¿”å›ç»“æ„åŒ–JSONæ•°æ®
- æ”¯æŒä¸­è‹±æ–‡å¤„ç†
- ä½¿ç”¨unstructuredåº“çš„é«˜åˆ†è¾¨ç‡ç­–ç•¥

### 2. å†…å®¹æå–èƒ½åŠ›
- âœ… **æ–‡æœ¬æå–**: æ­£æ–‡ã€æ ‡é¢˜ã€åˆ—è¡¨é¡¹ç­‰
- âœ… **è¡¨æ ¼æå–**: è¡¨æ ¼ç»“æ„å’Œå†…å®¹ï¼Œæ”¯æŒHTMLæ ¼å¼
- âœ… **å›¾ç‰‡æå–**: å›¾ç‰‡è¯†åˆ«å’Œæè¿°
- âœ… **åæ ‡è®°å½•**: æ¯ä¸ªå…ƒç´ çš„ç²¾ç¡®ä½ç½®ä¿¡æ¯
- âœ… **é¡µé¢ä¿¡æ¯**: é¡µç å’Œé¡µé¢ä¸Šä¸‹æ–‡
- âœ… **å…ƒæ•°æ®**: æ–‡ä»¶å“ˆå¸Œã€å¤§å°ã€æ—¶é—´ç­‰

### 3. ç‰¹æ®Šä¼˜åŒ–è®¾è®¡

#### å‘é‡åŒ–ä¼˜åŒ–
```json
{
  "vectorization_text": "[æ ‡é¢˜] ç¬¬ä¸€ç«  å¼•è¨€",
  "element_type_cn": "æ ‡é¢˜",
  "text_content": "ç¬¬ä¸€ç«  å¼•è¨€"
}
```

#### å®ä½“å…³ç³»ä¼˜åŒ–  
```json
{
  "context_info": {
    "position_in_document": {...},
    "page_context": {...},
    "type_context": {...}
  }
}
```

## ğŸ“Š JSONè¾“å‡ºç»“æ„

### ä¸»è¦ç»“æ„
```json
{
  "document_metadata": {
    "file_name": "æ–‡æ¡£åç§°.pdf",
    "file_path": "/ç»å¯¹è·¯å¾„/æ–‡æ¡£åç§°.pdf", 
    "file_size": æ–‡ä»¶å¤§å°,
    "file_hash": "æ–‡ä»¶MD5å“ˆå¸Œ",
    "created_time": "åˆ›å»ºæ—¶é—´",
    "modified_time": "ä¿®æ”¹æ—¶é—´"
  },
  "content_summary": {
    "total_characters": æ€»å­—ç¬¦æ•°,
    "total_pages": æ€»é¡µæ•°,
    "title_hierarchy": ["æ ‡é¢˜å±‚æ¬¡ç»“æ„"],
    "element_distribution": {"å…ƒç´ ç±»å‹": æ•°é‡},
    "has_tables": æ˜¯å¦åŒ…å«è¡¨æ ¼,
    "has_images": æ˜¯å¦åŒ…å«å›¾ç‰‡
  },
  "structured_content": [
    {
      "element_id": "å”¯ä¸€æ ‡è¯†ç¬¦",
      "element_type": "è‹±æ–‡ç±»å‹",
      "element_type_cn": "ä¸­æ–‡ç±»å‹", 
      "text_content": "æ–‡æœ¬å†…å®¹",
      "page_number": é¡µç ,
      "coordinates": "åæ ‡ä¿¡æ¯",
      "vectorization_text": "å‘é‡åŒ–æ–‡æœ¬",
      "context_info": "ä¸Šä¸‹æ–‡ä¿¡æ¯"
    }
  ],
  "extraction_metadata": {
    "extraction_time": "æå–æ—¶é—´",
    "total_elements": æ€»å…ƒç´ æ•°,
    "processing_strategy": "hi_res",
    "languages_detected": ["zh", "en"]
  }
}
```

## ğŸ¯ çŸ¥è¯†åº“é—®ç­”é€‚é…æ€§

### 1. å‘é‡åŒ–å°±ç»ª
- **vectorization_text**: åŒ…å«ç±»å‹æ ‡ç­¾çš„æ–‡æœ¬ï¼Œç›´æ¥å¯ç”¨äºåµŒå…¥
- **text_length**: æ”¯æŒæ–‡æœ¬åˆ†å—ç­–ç•¥
- **element_type_cn**: æ”¯æŒç±»å‹åŒ–æ£€ç´¢

### 2. å®ä½“å…³ç³»å°±ç»ª  
- **context_info**: ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- **coordinates**: ç©ºé—´å…³ç³»ä¿¡æ¯
- **page_context**: é¡µé¢çº§åˆ«å…³ç³»

### 3. æ£€ç´¢ä¼˜åŒ–
- **element_id**: å”¯ä¸€æ ‡è¯†ï¼Œæ”¯æŒç²¾ç¡®å®šä½
- **page_number**: æ”¯æŒé¡µé¢çº§åˆ«è¿‡æ»¤
- **type_context**: æ”¯æŒç±»å‹åŒ–æŸ¥è¯¢

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å¯¼å…¥æµ‹è¯• âœ…
```bash
âœ… PdfExtractService å¯¼å…¥æˆåŠŸ
```

### 2. æµ‹è¯•æ–‡ä»¶ âœ…
- `test/test_pdf_extract.py`: åŠŸèƒ½æµ‹è¯•
- `test/pdf_extract_example.py`: ä½¿ç”¨ç¤ºä¾‹

### 3. ä¾èµ–æ£€æŸ¥ âœ…
- requirements.txt åŒ…å« `unstructured[pdf]`
- è™šæ‹Ÿç¯å¢ƒé…ç½®æ­£ç¡®

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨
```python
from app.service.pdf.PdfExtractService import extract_pdf_content

# æ–¹æ³•1: å…¨å±€å‡½æ•°
result = extract_pdf_content("/path/to/pdf/file.pdf")

# æ–¹æ³•2: ç±»å®ä¾‹
from app.service.pdf.PdfExtractService import PdfExtractService
extractor = PdfExtractService()
result = extractor.extract_pdf_content("/path/to/pdf/file.pdf")
```

### ç»“æœå¤„ç†
```python
# è·å–æ–‡æ¡£ä¿¡æ¯
doc_info = result['document_metadata']
content_summary = result['content_summary'] 

# è·å–ç»“æ„åŒ–å†…å®¹
elements = result['structured_content']
for element in elements:
    # å‘é‡åŒ–æ–‡æœ¬
    vector_text = element['vectorization_text']
    # ä¸Šä¸‹æ–‡ä¿¡æ¯
    context = element['context_info']
```

## âœ… å®ç°ç¡®è®¤

**ä¸¥æ ¼æŒ‰ç…§éœ€æ±‚æ–‡æ¡£å®ç°:**
1. âœ… æŠ€æœ¯æ ˆ: ä½¿ç”¨unstructuredåº“
2. âœ… ä½ç½®: app/service/pdf/PdfExtractService.py
3. âœ… æ¥å£: å•ä¸€å…¥å£ï¼Œè·¯å¾„è¾“å…¥ï¼ŒJSONè¾“å‡º
4. âœ… åŠŸèƒ½: æ–‡æœ¬ã€æ ‡é¢˜ã€è¡¨æ ¼ã€å›¾ç‰‡æå–
5. âœ… å¤šè¯­è¨€: ä¸­è‹±æ–‡æ”¯æŒ
6. âœ… åæ ‡: å®Œæ•´çš„ä½ç½®å’Œå…ƒæ•°æ®ä¿¡æ¯
7. âœ… é€‚é…: å‘é‡åŒ–å’Œå®ä½“å…³ç³»æå–ä¼˜åŒ–
8. âœ… ç›®æ ‡: æ”¯æŒçŸ¥è¯†åº“é—®ç­”åœºæ™¯

**è´¨é‡ä¿è¯:**
- ä»£ç æ— lintingé”™è¯¯
- å®Œæ•´çš„é”™è¯¯å¤„ç†
- è¯¦ç»†çš„æ–‡æ¡£å’Œæ³¨é‡Š
- æµ‹è¯•ç”¨ä¾‹å’Œä½¿ç”¨ç¤ºä¾‹

## ğŸ‰ æ€»ç»“

PDFæå–æœåŠ¡å·²ä¸¥æ ¼æŒ‰ç…§ `doc/pdfæ–‡ä»¶çš„å®ç°.md` çš„æ‰€æœ‰è¦æ±‚æˆåŠŸå®ç°ï¼Œä¸ºGraphRAGç³»ç»Ÿçš„çŸ¥è¯†åº“é—®ç­”åŠŸèƒ½æä¾›äº†åšå®çš„åŸºç¡€ã€‚ç”Ÿæˆçš„JSONæ•°æ®ç»“æ„æ—¢æ»¡è¶³å‘é‡åŒ–éœ€æ±‚ï¼Œä¹Ÿæ”¯æŒå®ä½“å…³ç³»æå–ï¼Œç¡®ä¿åç»­çš„æ£€ç´¢å’Œé—®ç­”åŠŸèƒ½èƒ½å¤Ÿæœ‰æ•ˆè¿è¡Œã€‚