## 重要
项目的前置要求，参照：项目说明.md

## pdf类型的文件相关实现
1.所有内容都放在app/service/pdf目录下
2.在PdfExtractService.py这个文件中实现pdf文件内容的提取，使用Unstructured库，该文件只有一个入口，入参为文件绝对路径，返参为json

## 在PdfExtractService.py目标
基于unstructured库的PDF文档结构化内容提取系统，支持提取文本、标题、表格、图片等多种内容类型，并记录其坐标和元数据信息。

## 项目总体目标
实现知识库的问答，我问一个和pdf内容相关的问题，他可以把pdf的相关内容返回

## 功能描述
1.使用unstructured做结构化PDF提取，提取文本、标题、表格、图片等多种内容类型，并记录其坐标和元数据信息，需要支持中文和英文
2.这个PdfExtractService.py文件实现的功能只要通过文件路径，能返回json即可
3.产出json的作用和要求
1）这个json是实现项目总体目标的基础，这里提供的数据若不能满足后面的功能，整体就不能实现目标
2）这个json会被向量化，需要考虑是否只向量化从pdf上提取下来的内容
3）这个json会被用来提取实体关系
4）这个json的格式需要满足向量化和实体关系的需要，必须保证这个结构经过向量或和实体关系后可以通过检索找到答案

## AI核心JSON输出结构说明

### 精简设计理念
基于AI功能需求分析，新的JSON结构只保留对**向量化、实体关系提取、知识库检索**有直接影响的核心字段，大幅提升处理效率和减少存储空间。

### 顶级结构
提取服务返回的精简JSON包含2个主要节点：

**实际数据案例**（来自真实提取结果）：
```json
{
  "document_info": {...},    // 文档核心信息，包含文件标识、名称和页数等元数据
  "elements": [...]          // AI核心元素数组，包含所有提取的文档元素（文本、标题、表格等）
}
```

### 1. document_info（文档核心信息）
**作用**: 提供文档识别和多文档检索所需的最小信息集
**内容说明**:

**实际数据案例**（来自真实提取结果）：
```json
{
  "file_hash": "c8a436bf8cfbb3a49da148f6f678afcc",  // 文档内容的MD5哈希值，作为文档唯一标识符，用于检索去重和缓存管理
  "file_name": "20240906-CHO试剂盒单页.pdf",         // 原始PDF文件名，用于检索结果展示和用户识别
  "total_pages": 4                                   // PDF文档总页数，用于页面级别过滤和分页检索
}
```

### 2. elements（AI核心元素）
**作用**: 存储AI功能所需的核心数据，每个元素包含6个核心字段
**内容说明**: 数组形式，每个元素包含以下字段：

**实际数据案例**（来自真实提取结果）：
```json
{
  "element_id": "elem_000000",                                    // 🎯 元素唯一标识符，用于向量索引和检索定位
  "vectorization_text": "[标题] CHO细胞宿主蛋白检测试剂盒",         // 🎯 向量化专用文本，带类型标记，直接用于embedding计算
  "text_content": "CHO细胞宿主蛋白检测试剂盒",                   // 🎯 原始文本内容，用于实体识别和关系提取
  "page_number": 1,                                              // 🎯 所在页码，用于结果定位和页面级别过滤
  "coordinates": {                                               // 🎯 元素坐标信息，用于空间关系分析
    "points": [                                                  // 矩形四个顶点坐标，按顺序连接形成边界框
      [63.952, 175.19799999999998],                             // 左上角坐标点
      [63.952, 209.19799999999998],                             // 左下角坐标点  
      [534.3080000000001, 209.19799999999998],                  // 右下角坐标点
      [534.3080000000001, 175.19799999999998]                   // 右上角坐标点
    ],
    "system": "<unstructured.documents.coordinates.PixelSpace object at 0x3256f2d50>", // 坐标系统类型，像素空间坐标
    "layout_width": null,                                        // 布局宽度（当前为空）
    "layout_height": null                                        // 布局高度（当前为空）
  },
  "context_info": {                                              // 🎯 上下文信息，用于关系推理和内容理解
    "position_in_document": {                                    // 文档中的位置信息
      "index": 0,                                                // 在文档中的元素索引，从0开始
      "relative_position": 0.0,                                  // 相对位置（0.0-1.0），表示在文档中的位置比例
      "is_beginning": true,                                      // 是否为文档开始部分，用于上下文推理
      "is_middle": false,                                        // 是否为文档中间部分
      "is_end": false                                            // 是否为文档结束部分
    },
    "page_context": {                                            // 页面上下文信息
      "page_number": 1,                                          // 页码（数字形式）
      "page_position": "第1页"                                    // 页码（中文描述），用于结果展示
    },
    "type_context": {                                            // 元素类型上下文
      "element_type": "Title",                                   // 元素类型，用于内容分类和处理策略
      "is_title": true,                                          // 是否为标题类型，影响向量化权重
      "is_content": false,                                       // 是否为正文内容
      "is_structured": false                                     // 是否为结构化数据（如表格）
    }
  }
}
```




